<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/basic.html}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div layout:fragment="content">

    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">상세페이지</h1>
            <div class="panel panel-default">
                <div class="panel-heading">

                </div>
                <div class="panel-body">

                        <div class="form-group has-success">
                            <label   class="control-label" for="bno" >글번호</label>
                            <input name="bno" type="text" readonly th:value="${dto.bno}" class="form-control"  id="bno" >
                        </div>
                        <div class="form-group has-success">
                            <label   class="control-label" for="title" >제 목</label>
                            <input name="title" type="text" readonly th:value="${dto.title}" class="form-control"  id="title"  placeholder="최소3글자 이상 작성해주세요">
                        </div>
                        <div class="form-group">
                            <label   class="control-label" for="title">내 용</label>
                            <textarea class="form-control" name="content" rows="3" readonly>[[${dto.content}]]</textarea>
                        </div>

                        <div class="form-group has-error">
                            <label class="control-label" for="writer">작성자</label>
                            <input name="writer" readonly type="text" th:value="${dto.writer}" class="form-control" id="writer"  placeholder="이름은요??">
                        </div>
                        <div class="form-group has-error">
                            <label class="control-label" for="writer">등록일자</label>
                            <input name="writer" readonly type="text" th:value="${dto.regDate}" class="form-control" id="writer"  placeholder="이름은요??">
                        </div>
                        <div class="form-group has-error">
                            <label class="control-label" for="writer">수정일자</label>
                            <input name="writer" readonly type="text" th:value="${dto.modDate}" class="form-control" id="writer"  placeholder="이름은요??">
                        </div>
                        <a th:href="|@{/board/modify(bno=${dto.bno})}&${pageRequestDTO.getLink()}|" class="btn btn-default">
                            수정
                        </a>
                        <a th:href="|@{/board/list}?${pageRequestDTO.getLink()}|" class="btn btn-default">
                            목록
<!--                            <button type="button" class="btn btn-default listBtn">목록</button>-->
                        </a>



                </div>
            </div>
            <div class="chat-panel panel panel-default">
                <div class="panel-heading">
                    <i class="fa fa-comments fa-fw"></i> Chat <button class="rBtn">rrrr</button>
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <ul class="chat replylist">
                        <li class=" clearfix"><div class="chat-body clearfix"><div class="header">
                                    <strong class="primary-font">aaaaaaaa</strong><small class="pull-right text-muted">
                                        <i class="fa fa-clock-o fa-fw"></i> 12 mins ago</small>
                                </div><p>aaaaaaa</p></div></li>


                    </ul>

                </div>
            </div>
        </div>


    </div>




    <!--content-->
</div>

<script layout:fragment="script" th:inline="javascript">
    var rrr = document.querySelector(".rBtn");
    var bno = [[${dto.bno}]];
    var str = "";
    var page = "";
    var replylist = $(".replylist");
    $.getJSON("/replies/list/" + bno, function (data){
        console.log(bno);
        str = "";
        replylist.html("");

        console.log(data.dtoList);
        for(let i = 0; i< data.dtoList.length; i++){
            str +=  '<li className=" clearfix"><div className="chat-body clearfix"><div className="header">'
            str +=  '<strong className="primary-font">'+ data.dtoList[i].rno + '</strong><small className="pull-right text-muted">'
            str +=  '<i className="fa fa-clock-o fa-fw"></i> 12 mins ago</small>'
            str +=  '</div><p>' + data.dtoList[i].replyText + '</p></div></li>'
        }
        replylist.html(str);


    });
    rrr.addEventListener("click", function (e){
        bno += 1;
        $.getJSON("/replies/list/" + bno, function (data){
            console.log(bno);
            str = "";
            replylist.html("");

            console.log(data.dtoList);
            for(let i = 0; i< data.dtoList.length; i++){
                str +=  '<li className=" clearfix"><div className="chat-body clearfix"><div className="header">'
                str +=  '<strong className="primary-font">'+ data.dtoList[i].rno + '</strong><small className="pull-right text-muted">'
                str +=  '<i className="fa fa-clock-o fa-fw"></i> 12 mins ago</small>'
                str +=  '</div><p>' + data.dtoList[i].replyText + '</p></div></li>'

            }

            replylist.html(str);




        });
    });







   // document.querySelector(".listBtn").addEventListener("click", function (e) {
   //     e.preventDefault();
   //
   //     let link = [[${pageRequestDTO.getLink()}]];
   //
   //     self.location = `/board/list?${link}`;
   // });



</script>



</body>
</html>